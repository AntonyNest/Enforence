"""
Структура ТЗ згідно КМУ Постанова №205.

Обов'язкові та опціональні розділи технічного завдання
на створення засобу інформатизації.
"""

from typing import Any

# Повна структура ТЗ згідно КМУ №205
KMU_205_STRUCTURE: dict[str, dict[str, Any]] = {
    "1": {
        "title": "Загальні відомості про засіб інформатизації",
        "mandatory": True,
        "subsections": [
            {
                "id": "1.1",
                "title": "Найменування засобу, замовника, виконавця",
                "description": "Повна та скорочена назва, реквізити сторін",
            },
            {
                "id": "1.2",
                "title": "Перелік документів (підстави)",
                "description": "Нормативні акти, договори, технічні умови",
            },
            {
                "id": "1.3",
                "title": "Призначення та цілі",
                "description": "Мета створення, очікувані результати",
            },
            {
                "id": "1.4",
                "title": "План-графік виконання етапів",
                "description": "Етапи робіт, терміни виконання",
            },
        ],
    },
    "2": {
        "title": "Відомості про робочий процес (бізнес-процеси)",
        "mandatory": True,
        "subsections": [
            {
                "id": "2.1",
                "title": "Опис робочих процесів",
                "description": "Поточні та цільові бізнес-процеси",
            },
            {
                "id": "2.2",
                "title": "Вимоги до ПЗ та технічних засобів",
                "description": "Програмне та апаратне забезпечення",
            },
            {
                "id": "2.3",
                "title": "Вимоги до інтерфейсів та дизайну",
                "description": "UI/UX вимоги, доступність",
            },
            {
                "id": "2.4",
                "title": "Архітектура зберігання та обміну даними",
                "description": "БД, інтеграції, формати обміну",
            },
            {
                "id": "2.5",
                "title": "Показники якості",
                "description": "Метрики продуктивності, надійності",
            },
            {
                "id": "2.6",
                "title": "Техніко-економічні характеристики",
                "description": "Вартість, ефективність, ROI",
            },
        ],
    },
    "3": {
        "title": "Вимоги до засобу інформатизації",
        "mandatory": True,
        "subsections": [
            {
                "id": "3.1",
                "title": "Вимоги в цілому",
                "description": "Загальні вимоги до системи",
            },
            {
                "id": "3.2",
                "title": "Функціональні та нефункціональні вимоги",
                "description": "Функціонал, продуктивність, масштабованість",
            },
            {
                "id": "3.3",
                "title": "Вимоги до видів забезпечення",
                "description": "Технічне, програмне, організаційне забезпечення",
            },
            {
                "id": "3.4",
                "title": "Вимоги до захисту інформації",
                "description": "Інформаційна безпека, КСЗІ, криптографія",
            },
            {
                "id": "3.5",
                "title": "Спеціальні вимоги",
                "description": "Додаткові специфічні вимоги",
            },
        ],
    },
    "4": {
        "title": "Склад та зміст робіт",
        "mandatory": True,
        "subsections": [
            {
                "id": "4.1",
                "title": "Етапи виконання робіт",
                "description": "Послідовність та зміст етапів",
            },
        ],
    },
    "5": {
        "title": "Порядок контролю та приймання",
        "mandatory": True,
        "subsections": [
            {
                "id": "5.1",
                "title": "Загальні вимоги до приймання",
                "description": "Процедура приймання, критерії",
            },
        ],
    },
    "6": {
        "title": "Вимоги до підготовки до введення в дію",
        "mandatory": True,
        "subsections": [
            {
                "id": "6.1",
                "title": "Підготовчі заходи",
                "description": "Навчання, міграція даних, пілотна експлуатація",
            },
        ],
    },
    "7": {
        "title": "Умови використання",
        "mandatory": True,
        "subsections": [
            {
                "id": "7.1",
                "title": "Умови та режим експлуатації",
                "description": "Технічні умови, графік роботи",
            },
        ],
    },
    "8": {
        "title": "Вимоги до документування",
        "mandatory": True,
        "subsections": [
            {
                "id": "8.1",
                "title": "Перелік документації",
                "description": "Список необхідних документів",
            },
        ],
    },
    "9": {
        "title": "Порядок внесення змін",
        "mandatory": False,
        "subsections": [],
    },
    "10": {
        "title": "Додатки",
        "mandatory": False,
        "subsections": [
            {
                "id": "10.1",
                "title": "План створення",
                "description": "Детальний план-графік",
            },
            {
                "id": "10.2",
                "title": "Заявка на модернізацію",
                "description": "Форма заявки",
            },
        ],
    },
}


def get_mandatory_sections() -> list[str]:
    """Отримання списку обов'язкових секцій."""
    return [
        section_id
        for section_id, section in KMU_205_STRUCTURE.items()
        if section["mandatory"]
    ]


def get_section_titles() -> dict[str, str]:
    """Отримання словника номер → назва секції."""
    return {
        section_id: section["title"]
        for section_id, section in KMU_205_STRUCTURE.items()
    }


def get_all_subsections(section_id: str) -> list[dict[str, str]]:
    """
    Отримання підсекцій для конкретної секції.

    Args:
        section_id: Номер секції.

    Returns:
        Список підсекцій з id, title, description.
    """
    section = KMU_205_STRUCTURE.get(section_id, {})
    return section.get("subsections", [])
